{"_path":"/notes/net/iczp-nuget","_dir":"net","_draft":false,"_partial":false,"_locale":"","title":"IczpNet Nuget包","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"iczpnet-nuget包"},"children":[{"type":"text","value":"IczpNet Nuget包"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.nuget.org/packages?q=IczpNet","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.nuget.org/packages?q=IczpNet"}]}]}]},{"type":"element","tag":"h2","props":{"id":"iczpnetabptrees"},"children":[{"type":"element","tag":"a","props":{"href":"https://www.nuget.org/packages?q=IczpNet.AbpTrees&includeComputedFrameworks=true&prerel=true&sortby=relevance","rel":["nofollow"]},"children":[{"type":"text","value":"IczpNet.AbpTrees"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"An abp module that provides standard tree structure entity implement."}]},{"type":"element","tag":"h3","props":{"id":"create-project-by-abp-cli"},"children":[{"type":"text","value":"Create project by Abp Cli"}]},{"type":"element","tag":"pre","props":{"code":"abp new IczpNet.AbpTreesDemo -t module --no-ui\n","language":"sql","meta":"","className":"language-sql shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"abp new IczpNet.AbpTreesDemo -t module --no-ui\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"build"},"children":[{"type":"text","value":"Build"}]},{"type":"element","tag":"pre","props":{"code":"dotnet build --configuration Release\n","language":"css","meta":"","className":"language-css shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"dotnet build --configuration Release\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-build","rel":["nofollow"]},"children":[{"type":"text","value":"https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-build"}]}]},{"type":"element","tag":"h3","props":{"id":"public-to-nugetorg"},"children":[{"type":"text","value":"Public to Nuget.org"}]},{"type":"element","tag":"pre","props":{"code":"dotnet nuget push \"src/*/bin/Release/*0.2.4.nupkg\" --skip-duplicate -k {APIKEY} --source https://api.nuget.org/v3/index.json\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"dotnet"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" nuget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" push"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" \"src/*/bin/Release/*0.2.4.nupkg\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" --skip-duplicate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" -k"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" {APIKEY}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":" --source"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" https://api.nuget.org/v3/index.json\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Installation"}]},{"type":"element","tag":"h5","props":{"id":"install-the-following-nuget-packages-see-how"},"children":[{"type":"text","value":"Install the following NuGet packages. (see how)"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"IczpNet.AbpTrees.Domain"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"IczpNet.AbpTrees.Application"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"IczpNet.AbpTrees.Application.Contracts"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"IczpNet.AbpTrees.Domain.Shared"}]}]},{"type":"element","tag":"h5","props":{"id":"add-dependsontypeofabptreesxxxmodule-attribute-to-configure-the-module-dependencies"},"children":[{"type":"text","value":"Add "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DependsOn(typeof(AbpTreesXxxModule))"}]},{"type":"text","value":" attribute to configure the module dependencies."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesdemodomain"},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Domain"}]}]},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"F:\\Dev\\abpvnext\\Iczp.AbpTrees\\Example\\src\\IczpNet.AbpTreesDemo.Domain\\AbpTreesDemoDomainModule.cs"}]},{"type":"element","tag":"pre","props":{"code":"[DependsOn(typeof(AbpTreesDomainModule))]\n","language":"c#","meta":"","className":"language-c# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"DependsOn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"AbpTreesDomainModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"))]\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesdemodomainshared"},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Domain.Shared"}]}]},{"type":"element","tag":"pre","props":{"code":"[DependsOn(typeof(AbpTreesDomainSharedModule))]\n","language":"c#","meta":"","className":"language-c# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"DependsOn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"AbpTreesDomainSharedModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"))]\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesdemoapplicationcontracts"},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Application.Contracts"}]}]},{"type":"element","tag":"pre","props":{"code":"[DependsOn(typeof(AbpTreesApplicationContractsModule))]\n","language":"c#","meta":"","className":"language-c# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"DependsOn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"AbpTreesApplicationContractsModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"))]\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesdemoapplication"},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Application"}]}]},{"type":"element","tag":"pre","props":{"code":"[DependsOn(typeof(AbpTreesApplicationModule))]\n","language":"c#","meta":"","className":"language-c# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"DependsOn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"AbpTreesApplicationModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"))]\n"}]}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"internal-structure"},"children":[{"type":"text","value":"Internal structure"}]},{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesdomain"},"children":[{"type":"text","value":"IczpNet.AbpTrees.Domain"}]},{"type":"element","tag":"h5","props":{"id":"itreeentity"},"children":[{"type":"text","value":"ITreeEntity"}]},{"type":"element","tag":"pre","props":{"code":"using System.Collections.Generic;\nusing Volo.Abp.Domain.Entities;\n\nnamespace IczpNet.AbpTrees\n{\n    public interface ITreeEntity<T, TKey> : ITreeEntity<TKey>\n        where T : ITreeEntity<TKey>\n        where TKey : struct\n    {\n        T Parent { get; }\n        IEnumerable<T> Childs { get; }\n        void SetName(string name);\n        void SetParent(T parent);\n        void SetParentId(TKey? parentId);\n    }\n\n\n    public interface ITreeEntity<TKey> : IEntity<TKey> where TKey : struct\n    {\n        string Name { get; }\n        TKey? ParentId { get; }\n        string FullPath { get; }\n        string FullPathName { get; }\n        int Depth { get; }\n        double Sorting { get; set; }\n        string Description { get; set; }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Collections.Generic;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Domain.Entities;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeEntity<T, TKey> : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        T Parent { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        IEnumerable<T> Childs { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        void SetName(string name);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        void SetParent(T parent);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        void SetParentId(TKey? parentId);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeEntity<TKey> : IEntity<TKey> where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        string Name { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        TKey? ParentId { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        string FullPath { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        string FullPathName { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        int Depth { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        double Sorting { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        string Description { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h5","props":{"id":"treeentity"},"children":[{"type":"text","value":"TreeEntity"}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees.Statics;\nusing System;\nusing System.Collections.Generic;\nusing System.ComponentModel.DataAnnotations;\nusing System.ComponentModel.DataAnnotations.Schema;\nusing System.Linq;\nusing Volo.Abp.Domain.Entities.Auditing;\n\nnamespace IczpNet.AbpTrees\n{\n    public abstract class TreeEntity<T, TKey> : FullAuditedAggregateRoot<TKey>, ITreeEntity<T, TKey>\n        where T : ITreeEntity<TKey>\n        where TKey : struct\n    {\n        [MaxLength(64)]\n        [Required(ErrorMessage = \"Name Required.\")]\n        public virtual string Name { get; protected set; }\n\n        public virtual TKey? ParentId { get; set; }\n\n        [MaxLength(1000)]\n        [Required]\n        public virtual string FullPath { get; protected set; }\n\n        [MaxLength(1000)]\n        [Required]\n        public virtual string FullPathName { get; protected set; }\n\n        /// <summary>\n        /// 层级\n        /// </summary>\n        [Range(0, 1024)]\n        public virtual int Depth { get; protected set; }\n\n        public virtual double Sorting { get; set; }\n\n        [MaxLength(500)]\n        public virtual string Description { get; set; }\n\n        public virtual int GetChildsCount()\n        {\n            return Childs.Count();\n        }\n\n        /// <summary>\n        /// 父级角色\n        /// </summary>\n        [ForeignKey(nameof(ParentId))]\n        public virtual T Parent { get; protected set; }\n\n        /// <summary>\n        /// 子集合\n        /// </summary>\n        public virtual IEnumerable<T> Childs { get; protected set; }\n\n        protected TreeEntity()\n        {\n\n        }\n\n        protected TreeEntity(TKey id, string name, TKey? parentId) : base(id)\n        {\n            SetId(id);\n            SetParentId(parentId);\n            SetName(name);\n            SetFullPath(null);\n            SetFullPathName(null);\n        }\n\n        public virtual void SetParentId(TKey? parentId)\n        {\n            ParentId = parentId;\n        }\n\n        protected virtual void SetId(TKey id)\n        {\n            Id = id;\n        }\n\n        public virtual void SetName(string name)\n        {\n            Name = name;\n        }\n\n        protected virtual void SetFullPath(string parentPath)\n        {\n            FullPath = parentPath.IsNullOrEmpty() ? $\"{Id}\" : $\"{parentPath}{AbpTreesConsts.SplitPath}{Id}\";\n        }\n\n        protected virtual void SetFullPathName(string parentPathName)\n        {\n            FullPathName = parentPathName.IsNullOrEmpty() ? $\"{Name}\" : $\"{parentPathName}{AbpTreesConsts.SplitPath}{Name}\";\n        }\n\n        protected virtual void SetDepth(int depth)\n        {\n            Depth = depth;\n        }\n\n        public virtual void SetParent(T parent)\n        {\n            if (parent == null)\n            {\n                SetDepth(0);\n                SetFullPath(null);\n                SetFullPathName(null);\n            }\n            else\n            {\n                Parent = parent;\n                Assert.If(Parent.Depth >= AbpTreesConsts.MaxDepth, $\"超出最大层级:{AbpTreesConsts.MaxDepth}\");\n                SetDepth(Parent.Depth + 1);\n                SetFullPath(parent.FullPath);\n                SetFullPathName(parent.FullPathName);\n            }\n        }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Statics;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Collections.Generic;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.ComponentModel.DataAnnotations;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.ComponentModel.DataAnnotations.Schema;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Linq;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Domain.Entities.Auditing;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public abstract class TreeEntity<T, TKey> : FullAuditedAggregateRoot<TKey>, ITreeEntity<T, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [MaxLength(64)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [Required(ErrorMessage = \"Name Required.\")]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string Name { get; protected set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual TKey? ParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [MaxLength(1000)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [Required]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string FullPath { get; protected set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [MaxLength(1000)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [Required]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string FullPathName { get; protected set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 层级\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [Range(0, 1024)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual int Depth { get; protected set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual double Sorting { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [MaxLength(500)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string Description { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual int GetChildsCount()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Childs.Count();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 父级角色\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [ForeignKey(nameof(ParentId))]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual T Parent { get; protected set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 子集合\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual IEnumerable<T> Childs { get; protected set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected TreeEntity()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected TreeEntity(TKey id, string name, TKey? parentId) : base(id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            SetId(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            SetParentId(parentId);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            SetName(name);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            SetFullPath(null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            SetFullPathName(null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual void SetParentId(TKey? parentId)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            ParentId = parentId;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual void SetId(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Id = id;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual void SetName(string name)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Name = name;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual void SetFullPath(string parentPath)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            FullPath = parentPath.IsNullOrEmpty() ? $\"{Id}\" : $\"{parentPath}{AbpTreesConsts.SplitPath}{Id}\";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual void SetFullPathName(string parentPathName)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            FullPathName = parentPathName.IsNullOrEmpty() ? $\"{Name}\" : $\"{parentPathName}{AbpTreesConsts.SplitPath}{Name}\";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual void SetDepth(int depth)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Depth = depth;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual void SetParent(T parent)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":102},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            if (parent == null)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":103},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":104},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                SetDepth(0);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":105},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                SetFullPath(null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":106},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                SetFullPathName(null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":107},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":108},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            else\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":109},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":110},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                Parent = parent;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":111},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                Assert.If(Parent.Depth >= AbpTreesConsts.MaxDepth, $\"超出最大层级:{AbpTreesConsts.MaxDepth}\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":112},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                SetDepth(Parent.Depth + 1);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":113},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                SetFullPath(parent.FullPath);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":114},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                SetFullPathName(parent.FullPathName);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":115},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":116},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":117},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":118},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h5","props":{"id":"itreemanager"},"children":[{"type":"text","value":"ITreeManager"}]},{"type":"element","tag":"pre","props":{"code":"using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Volo.Abp.Domain.Services;\n\nnamespace IczpNet.AbpTrees\n{\n    public interface ITreeManager<T, TKey, TTreeInfo, TWithChildsOuput, TwithParentOuput> : ITreeManager<T, TKey, TTreeInfo, TWithChildsOuput>, IDomainService\n        where T : ITreeEntity<TKey>\n        where TKey : struct\n        where TTreeInfo : ITreeInfo<TKey>\n        where TWithChildsOuput : ITreeWithChildsInfo<TWithChildsOuput>\n        where TwithParentOuput : ITreeWithParentInfo<TwithParentOuput>\n    {\n        Task<TwithParentOuput> GetWithParentAsync(TKey id);\n    }\n    public interface ITreeManager<T, TKey, TTreeInfo, TWithChildsOuput> : ITreeManager<T, TKey, TTreeInfo>, IDomainService\n        where T : ITreeEntity<TKey>\n        where TKey : struct\n        where TTreeInfo : ITreeInfo<TKey>\n        where TWithChildsOuput : ITreeWithChildsInfo<TWithChildsOuput>\n    {\n        Task<List<TWithChildsOuput>> GetAllListWithChildsAsync(TKey? parentId, bool isImportAllChilds = false);\n        Task<List<TWithChildsOuput>> GetRootListAsync(List<TKey> idList);\n    }\n    public interface ITreeManager<T, TKey, TTreeOutput> : ITreeManager<T, TKey>, IDomainService\n        where T : ITreeEntity<TKey>\n        where TKey : struct\n        where TTreeOutput : ITreeInfo<TKey>\n    {\n        Task<List<TTreeOutput>> GetAllByCacheAsync();\n    }\n\n    public interface ITreeManager<T, TKey> : IDomainService\n        where T : ITreeEntity<TKey>\n        where TKey : struct\n    {\n        Task RemoveCacheAsync();\n        /// <summary>\n        /// 查找当前目录及所有子目录\n        /// </summary>\n        /// <param name=\"treeEntityIdList\"></param>\n        /// <returns></returns>\n        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<TKey> treeEntityIdList);\n        /// <summary>\n        /// 查找当前目录及所有子目录\n        /// </summary>\n        /// <param name=\"treeEntityIdList\"></param>\n        /// <returns></returns>\n        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(TKey treeEntityIdList);\n        /// <summary>\n        /// 查找当前目录及所有子目录\n        /// </summary>\n        /// <param name=\"fullPath\"></param>\n        /// <returns></returns>\n        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(string fullPath);\n        /// <summary>\n        /// 查找当前目录及所有子目录\n        /// </summary>\n        /// <param name=\"fullPaths\"></param>\n        /// <returns></returns>\n        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<string> fullPaths);\n        Task<T> FindAsync(TKey id);\n        Task<T> GetAsync(TKey id);\n        Task<List<T>> GetManyAsync(IEnumerable<TKey> idList);\n        //Task<T> CreateAsync(string name, TKey? parentId, long sorting, string description);\n        Task<T> CreateAsync(T entity);\n        Task<T> UpdateAsync(T entity);\n        Task DeleteAsync(TKey id);\n        /// <summary>\n        /// 获取子目录\n        /// </summary>\n        /// <param name=\"entityId\"></param>\n        /// <returns></returns>\n        Task<List<T>> GetChildsAsync(TKey? entityId);\n\n        Task RepairDataAsync();\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Collections.Generic;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Linq;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Threading.Tasks;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Domain.Services;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeManager<T, TKey, TTreeInfo, TWithChildsOuput, TwithParentOuput> : ITreeManager<T, TKey, TTreeInfo, TWithChildsOuput>, IDomainService\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TTreeInfo : ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TWithChildsOuput : ITreeWithChildsInfo<TWithChildsOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TwithParentOuput : ITreeWithParentInfo<TwithParentOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<TwithParentOuput> GetWithParentAsync(TKey id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeManager<T, TKey, TTreeInfo, TWithChildsOuput> : ITreeManager<T, TKey, TTreeInfo>, IDomainService\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TTreeInfo : ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TWithChildsOuput : ITreeWithChildsInfo<TWithChildsOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<TWithChildsOuput>> GetAllListWithChildsAsync(TKey? parentId, bool isImportAllChilds = false);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<TWithChildsOuput>> GetRootListAsync(List<TKey> idList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeManager<T, TKey, TTreeOutput> : ITreeManager<T, TKey>, IDomainService\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TTreeOutput : ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<TTreeOutput>> GetAllByCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeManager<T, TKey> : IDomainService\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : ITreeEntity<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task RemoveCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 查找当前目录及所有子目录\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <param name=\"treeEntityIdList\"></param>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <returns></returns>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<TKey> treeEntityIdList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 查找当前目录及所有子目录\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <param name=\"treeEntityIdList\"></param>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <returns></returns>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(TKey treeEntityIdList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 查找当前目录及所有子目录\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <param name=\"fullPath\"></param>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <returns></returns>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(string fullPath);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 查找当前目录及所有子目录\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <param name=\"fullPaths\"></param>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <returns></returns>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<string> fullPaths);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<T> FindAsync(TKey id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<T> GetAsync(TKey id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<T>> GetManyAsync(IEnumerable<TKey> idList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        //Task<T> CreateAsync(string name, TKey? parentId, long sorting, string description);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<T> CreateAsync(T entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<T> UpdateAsync(T entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task DeleteAsync(TKey id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// 获取子目录\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <param name=\"entityId\"></param>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        /// <returns></returns>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<T>> GetChildsAsync(TKey? entityId);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task RepairDataAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h5","props":{"id":"treemanager"},"children":[{"type":"text","value":"TreeManager"}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees.Statics;\nusing Microsoft.Extensions.Logging;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Volo.Abp.Caching;\nusing Volo.Abp.Domain.Repositories;\nusing Volo.Abp.Domain.Services;\nusing Volo.Abp.ObjectMapping;\n\nnamespace IczpNet.AbpTrees\n{\n    public class TreeManager<T, TKey, TOutput, TWithChildsOuput, TWithParentOuput> : TreeManager<T, TKey, TOutput, TWithChildsOuput>, ITreeManager<T, TKey, TOutput, TWithChildsOuput, TWithParentOuput>\n         where T : class, ITreeEntity<T, TKey>\n        where TKey : struct\n        where TOutput : class, ITreeInfo<TKey>\n        where TWithChildsOuput : class, ITreeWithChildsInfo<TWithChildsOuput>\n        where TWithParentOuput : class, ITreeWithParentInfo<TWithParentOuput>\n    {\n        public TreeManager(IRepository<T, TKey> repository) : base(repository) { }\n\n        public async Task<TWithParentOuput> GetWithParentAsync(TKey id)\n        {\n            var entity = await GetAsync(id);\n            return ObjectMapper.Map<T, TWithParentOuput>(entity);\n        }\n    }\n    public class TreeManager<T, TKey, TOutput, TWithChildsOuput> : TreeManager<T, TKey, TOutput>, ITreeManager<T, TKey, TOutput, TWithChildsOuput>\n         where T : class, ITreeEntity<T, TKey>\n        where TKey : struct\n        where TOutput : class, ITreeInfo<TKey>\n        where TWithChildsOuput : class, ITreeWithChildsInfo<TWithChildsOuput>\n    {\n        public TreeManager(IRepository<T, TKey> repository) : base(repository) { }\n\n        public override Task RemoveCacheAsync()\n        {\n            return Cache.RemoveAsync(CacheKey);\n        }\n\n        public virtual async Task<List<TWithChildsOuput>> GetAllListWithChildsAsync(TKey? parentId, bool isImportAllChilds = false)\n        {\n            var allList = await GetAllByCacheAsync();\n\n            return await GetChildsAsync(allList, parentId, isImportAllChilds);\n        }\n\n        private async Task<List<TWithChildsOuput>> GetChildsAsync(List<TOutput> allList, TKey? parentId, bool isImportAllChilds)\n        {\n            var list = new List<TWithChildsOuput>();\n\n            foreach (var treeInfo in allList.Where(x => x.ParentId.Equals(parentId) ).ToList())\n            {\n                var item = ObjectMapper.Map<TOutput, TWithChildsOuput>(treeInfo);\n\n                if (isImportAllChilds)\n                {\n                    item.Childs = await GetChildsAsync(allList, treeInfo.Id, isImportAllChilds);\n                }\n                list.Add(item);\n            }\n            return list;\n        }\n\n        public virtual async Task<List<TWithChildsOuput>> GetRootListAsync(List<TKey> idList)\n        {\n            var rootList = (await Repository.GetQueryableAsync())\n               .Where(x => x.ParentId == null)\n               .WhereIf(idList != null && idList.Any(), x => idList.Contains(x.Id))\n               .ToList();\n\n            return ObjectMapper.Map<List<T>, List<TWithChildsOuput>>(rootList);\n        }\n    }\n\n    public class TreeManager<T, TKey, TOutput> : TreeManager<T, TKey>, ITreeManager<T, TKey, TOutput>\n        where T : class, ITreeEntity<T, TKey>\n        where TKey : struct\n        where TOutput : class, ITreeInfo<TKey>\n    {\n\n        protected IObjectMapper ObjectMapper => LazyServiceProvider.LazyGetRequiredService<IObjectMapper>();\n        protected IDistributedCache<List<TOutput>> Cache => LazyServiceProvider.LazyGetRequiredService<IDistributedCache<List<TOutput>>>();\n\n        public TreeManager(IRepository<T, TKey> repository) : base(repository) { }\n\n        public override Task RemoveCacheAsync()\n        {\n            return Cache.RemoveAsync(CacheKey);\n        }\n\n        public virtual Task<List<TOutput>> GetAllByCacheAsync()\n        {\n            return Cache.GetOrAddAsync(CacheKey, async () =>\n            {\n                var list = (await Repository.GetQueryableAsync()).OrderByDescending(x => x.Sorting).ToList();\n\n                var result = new List<TOutput>();\n\n                foreach (var item in list)\n                {\n                    result.Add(ObjectMapper.Map<T, TOutput>(item));\n                }\n                return await Task.FromResult(result);\n            });\n        }\n    }\n\n\n    public class TreeManager<T, TKey> : DomainService, ITreeManager<T, TKey>\n        where T : class, ITreeEntity<T, TKey>\n        where TKey : struct\n    {\n        public virtual string CacheKey => typeof(T).FullName;\n        public IRepository<T, TKey> Repository { get; }\n        public TreeManager(IRepository<T, TKey> repository)\n        {\n            Repository = repository;\n        }\n\n        public virtual async Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<TKey> departmentIdList)\n        {\n            var fullPathsQueryable = (await Repository.GetQueryableAsync())\n                .Where(x => departmentIdList.Contains(x.Id))\n                .Select(x => x.FullPath)\n            ;\n\n            var fullPathList = await AsyncExecuter.ToListAsync(fullPathsQueryable);\n\n            return await QueryCurrentAndAllChildsAsync(fullPathList);\n        }\n        public virtual async Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<string> fullPaths)\n        {\n            var entityPredicate = PredicateBuilder.New<T>();\n\n            foreach (var fullPath in fullPaths)\n            {\n                entityPredicate = entityPredicate.Or(x => x.FullPath.StartsWith(fullPath));\n            }\n\n            var entityIdQuery = (await Repository.GetQueryableAsync())\n                .Where(entityPredicate)\n            ;\n\n            //Logger.LogDebug(\"entityIdQuery:\\r\\n\" + entityIdQuery.ToQueryString());\n            //Logger.LogDebug(\"entityIdQuery:\\r\\n\" + string.Join(\",\", entityIdQuery.ToList()));\n\n            return entityIdQuery;\n        }\n        public virtual Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(string fullPath)\n        {\n            return QueryCurrentAndAllChildsAsync(new List<string>() { fullPath });\n        }\n\n        public virtual Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(TKey departmentId)\n        {\n            return QueryCurrentAndAllChildsAsync(new List<TKey>() { departmentId });\n        }\n\n        public virtual Task RemoveCacheAsync()\n        {\n            //return Cache.RemoveAsync(CacheKey);\n            return Task.CompletedTask;\n        }\n\n        public virtual Task<T> FindAsync(TKey id)\n        {\n            return Repository.FindAsync(id);\n        }\n\n        public virtual Task<T> GetAsync(TKey id)\n        {\n            return Repository.GetAsync(id);\n        }\n\n        public virtual Task<List<T>> GetManyAsync(IEnumerable<TKey> idList)\n        {\n            return Repository.GetListAsync(x => idList.Contains(x.Id));\n        }\n\n        public virtual async Task<T> CreateAsync(T inputEntity)\n        {\n            Assert.If(await Repository.CountAsync(x => x.Name == inputEntity.Name) > 0, $\"Already exists:{inputEntity.Name}\");\n\n            if (inputEntity.ParentId.HasValue)\n            {\n                var parent = await Repository.GetAsync(inputEntity.ParentId.Value);\n\n                Assert.NotNull(parent, $\"No such parent entity:{inputEntity.ParentId}\");\n\n                inputEntity.SetParent(parent);\n            }\n            else\n            {\n                inputEntity.SetParent(null);\n            }\n\n            var entity = await Repository.InsertAsync(inputEntity, autoSave: true);\n\n            await RemoveCacheAsync();\n\n            return entity;\n        }\n\n        public virtual async Task<T> UpdateAsync(T entity)\n        {\n            Assert.NotNull(entity, $\"an entity is no such.\");\n\n            Assert.NotNull(entity.Name, $\"[Name] cannot be null.\");\n\n            Assert.If(entity.Name.Contains(AbpTreesConsts.SplitPath), $\"[Name] cannot contains char:\\\"/\\\"\");\n\n            Assert.If(await Repository.CountAsync(x => x.Name == entity.Name && !x.Id.Equals(entity.Id)) > 0, $\" Name[{entity.Name}] already such.\");\n\n            //entity.SetName(entity.Name);\n\n            if (entity.ParentId.HasValue)\n            {\n                //变更上级\n                var parent = await Repository.GetAsync(entity.ParentId.Value);\n\n                Assert.NotNull(parent, $\"[Parent] is no such.\");\n\n                entity.SetParent(parent);\n            }\n            else\n            {\n                entity.SetParent(null);\n            }\n\n            //update childs\n            await ChangeChildsAsync(entity);\n\n            await RemoveCacheAsync();\n\n            return entity;\n        }\n\n        protected virtual async Task ChangeChildsAsync(T entiy)\n        {\n            Logger.LogInformation($\"ChangeChilds id:{entiy.Id}\");\n\n            foreach (var item in entiy.Childs)\n            {\n                item.SetParent(entiy);\n\n                await ChangeChildsAsync(item);\n            }\n        }\n\n        public virtual async Task DeleteAsync(TKey id)\n        {\n            var entity = await Repository.GetAsync(id);\n\n            var childCount = entity.Childs.Count();\n\n            Assert.If(childCount > 0, $\"Has ({childCount}) childs, cannot delete.\");\n\n            await Repository.DeleteAsync(entity);\n\n            await RemoveCacheAsync();\n        }\n\n        public async Task<List<T>> GetChildsAsync(TKey? entityId)\n        {\n            //return await Repository.GetListAsync(x => x.ParentId == departmentId);\n            return (await Repository.GetQueryableAsync())\n                .Where(x => x.ParentId.Equals(entityId))\n                .OrderByDescending(x => x.Sorting)\n                .ToList();\n        }\n\n        public virtual async Task RepairDataAsync()\n        {\n            var list = await Repository.GetListAsync(x => x.ParentId == null);\n\n            foreach (var entity in list)\n            {\n                await SetEntityAsync(entity);\n\n                await UpdateAsync(entity);\n            }\n        }\n\n        protected virtual Task SetEntityAsync(T entity)\n        {\n            Logger.LogInformation($\"SetEntityAsync:{entity}\");\n\n            entity.SetName(entity.Name);\n\n            return Task.CompletedTask;\n        }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Statics;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Microsoft.Extensions.Logging;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Collections.Generic;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Linq;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Threading.Tasks;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Caching;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Domain.Repositories;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Domain.Services;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.ObjectMapping;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class TreeManager<T, TKey, TOutput, TWithChildsOuput, TWithParentOuput> : TreeManager<T, TKey, TOutput, TWithChildsOuput>, ITreeManager<T, TKey, TOutput, TWithChildsOuput, TWithParentOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"         where T : class, ITreeEntity<T, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TOutput : class, ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TWithChildsOuput : class, ITreeWithChildsInfo<TWithChildsOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TWithParentOuput : class, ITreeWithParentInfo<TWithParentOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public TreeManager(IRepository<T, TKey> repository) : base(repository) { }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public async Task<TWithParentOuput> GetWithParentAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entity = await GetAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return ObjectMapper.Map<T, TWithParentOuput>(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class TreeManager<T, TKey, TOutput, TWithChildsOuput> : TreeManager<T, TKey, TOutput>, ITreeManager<T, TKey, TOutput, TWithChildsOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"         where T : class, ITreeEntity<T, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TOutput : class, ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TWithChildsOuput : class, ITreeWithChildsInfo<TWithChildsOuput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public TreeManager(IRepository<T, TKey> repository) : base(repository) { }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override Task RemoveCacheAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Cache.RemoveAsync(CacheKey);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<List<TWithChildsOuput>> GetAllListWithChildsAsync(TKey? parentId, bool isImportAllChilds = false)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var allList = await GetAllByCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return await GetChildsAsync(allList, parentId, isImportAllChilds);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        private async Task<List<TWithChildsOuput>> GetChildsAsync(List<TOutput> allList, TKey? parentId, bool isImportAllChilds)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var list = new List<TWithChildsOuput>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            foreach (var treeInfo in allList.Where(x => x.ParentId.Equals(parentId) ).ToList())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                var item = ObjectMapper.Map<TOutput, TWithChildsOuput>(treeInfo);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                if (isImportAllChilds)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                    item.Childs = await GetChildsAsync(allList, treeInfo.Id, isImportAllChilds);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                list.Add(item);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return list;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<List<TWithChildsOuput>> GetRootListAsync(List<TKey> idList)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var rootList = (await Repository.GetQueryableAsync())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"               .Where(x => x.ParentId == null)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"               .WhereIf(idList != null && idList.Any(), x => idList.Contains(x.Id))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"               .ToList();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return ObjectMapper.Map<List<T>, List<TWithChildsOuput>>(rootList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class TreeManager<T, TKey, TOutput> : TreeManager<T, TKey>, ITreeManager<T, TKey, TOutput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : class, ITreeEntity<T, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TOutput : class, ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected IObjectMapper ObjectMapper => LazyServiceProvider.LazyGetRequiredService<IObjectMapper>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected IDistributedCache<List<TOutput>> Cache => LazyServiceProvider.LazyGetRequiredService<IDistributedCache<List<TOutput>>>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public TreeManager(IRepository<T, TKey> repository) : base(repository) { }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override Task RemoveCacheAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Cache.RemoveAsync(CacheKey);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<List<TOutput>> GetAllByCacheAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Cache.GetOrAddAsync(CacheKey, async () =>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                var list = (await Repository.GetQueryableAsync()).OrderByDescending(x => x.Sorting).ToList();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                var result = new List<TOutput>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                foreach (var item in list)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":102},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":103},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                    result.Add(ObjectMapper.Map<T, TOutput>(item));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":104},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":105},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                return await Task.FromResult(result);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":106},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":107},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":108},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":109},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":110},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":111},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class TreeManager<T, TKey> : DomainService, ITreeManager<T, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":112},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where T : class, ITreeEntity<T, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":113},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":114},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":115},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string CacheKey => typeof(T).FullName;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":116},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public IRepository<T, TKey> Repository { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":117},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public TreeManager(IRepository<T, TKey> repository)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":118},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":119},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Repository = repository;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":120},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":121},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":122},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<TKey> departmentIdList)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":123},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":124},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var fullPathsQueryable = (await Repository.GetQueryableAsync())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":125},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .Where(x => departmentIdList.Contains(x.Id))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":126},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .Select(x => x.FullPath)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":127},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            ;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":128},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":129},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var fullPathList = await AsyncExecuter.ToListAsync(fullPathsQueryable);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":130},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":131},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return await QueryCurrentAndAllChildsAsync(fullPathList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":132},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":133},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(IEnumerable<string> fullPaths)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":134},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":135},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entityPredicate = PredicateBuilder.New<T>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":136},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":137},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            foreach (var fullPath in fullPaths)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":138},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":139},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                entityPredicate = entityPredicate.Or(x => x.FullPath.StartsWith(fullPath));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":140},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":141},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":142},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entityIdQuery = (await Repository.GetQueryableAsync())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":143},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .Where(entityPredicate)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":144},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            ;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":145},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":146},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //Logger.LogDebug(\"entityIdQuery:\\r\\n\" + entityIdQuery.ToQueryString());\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":147},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //Logger.LogDebug(\"entityIdQuery:\\r\\n\" + string.Join(\",\", entityIdQuery.ToList()));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":148},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":149},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return entityIdQuery;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":150},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":151},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(string fullPath)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":152},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":153},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return QueryCurrentAndAllChildsAsync(new List<string>() { fullPath });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":154},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":155},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":156},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<IQueryable<T>> QueryCurrentAndAllChildsAsync(TKey departmentId)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":157},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":158},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return QueryCurrentAndAllChildsAsync(new List<TKey>() { departmentId });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":159},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":160},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":161},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task RemoveCacheAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":162},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":163},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //return Cache.RemoveAsync(CacheKey);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":164},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Task.CompletedTask;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":165},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":166},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":167},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<T> FindAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":168},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":169},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Repository.FindAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":170},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":171},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":172},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<T> GetAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":173},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":174},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Repository.GetAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":175},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":176},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":177},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<List<T>> GetManyAsync(IEnumerable<TKey> idList)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":178},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":179},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Repository.GetListAsync(x => idList.Contains(x.Id));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":180},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":181},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":182},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<T> CreateAsync(T inputEntity)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":183},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":184},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.If(await Repository.CountAsync(x => x.Name == inputEntity.Name) > 0, $\"Already exists:{inputEntity.Name}\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":185},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":186},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            if (inputEntity.ParentId.HasValue)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":187},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":188},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                var parent = await Repository.GetAsync(inputEntity.ParentId.Value);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":189},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":190},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                Assert.NotNull(parent, $\"No such parent entity:{inputEntity.ParentId}\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":191},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":192},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                inputEntity.SetParent(parent);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":193},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":194},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            else\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":195},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":196},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                inputEntity.SetParent(null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":197},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":198},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":199},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entity = await Repository.InsertAsync(inputEntity, autoSave: true);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":200},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":201},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await RemoveCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":202},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":203},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return entity;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":204},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":205},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":206},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<T> UpdateAsync(T entity)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":207},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":208},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.NotNull(entity, $\"an entity is no such.\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":209},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":210},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.NotNull(entity.Name, $\"[Name] cannot be null.\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":211},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":212},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.If(entity.Name.Contains(AbpTreesConsts.SplitPath), $\"[Name] cannot contains char:\\\"/\\\"\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":213},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":214},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.If(await Repository.CountAsync(x => x.Name == entity.Name && !x.Id.Equals(entity.Id)) > 0, $\" Name[{entity.Name}] already such.\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":215},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":216},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //entity.SetName(entity.Name);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":217},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":218},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            if (entity.ParentId.HasValue)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":219},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":220},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                //变更上级\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":221},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                var parent = await Repository.GetAsync(entity.ParentId.Value);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":222},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":223},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                Assert.NotNull(parent, $\"[Parent] is no such.\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":224},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":225},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                entity.SetParent(parent);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":226},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":227},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            else\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":228},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":229},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                entity.SetParent(null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":230},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":231},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":232},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //update childs\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":233},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await ChangeChildsAsync(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":234},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":235},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await RemoveCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":236},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":237},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return entity;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":238},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":239},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":240},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual async Task ChangeChildsAsync(T entiy)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":241},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":242},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Logger.LogInformation($\"ChangeChilds id:{entiy.Id}\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":243},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":244},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            foreach (var item in entiy.Childs)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":245},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":246},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                item.SetParent(entiy);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":247},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":248},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                await ChangeChildsAsync(item);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":249},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":250},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":251},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":252},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task DeleteAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":253},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":254},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entity = await Repository.GetAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":255},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":256},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var childCount = entity.Childs.Count();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":257},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":258},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.If(childCount > 0, $\"Has ({childCount}) childs, cannot delete.\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":259},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":260},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await Repository.DeleteAsync(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":261},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":262},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await RemoveCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":263},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":264},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":265},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public async Task<List<T>> GetChildsAsync(TKey? entityId)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":266},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":267},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //return await Repository.GetListAsync(x => x.ParentId == departmentId);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":268},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return (await Repository.GetQueryableAsync())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":269},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .Where(x => x.ParentId.Equals(entityId))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":270},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .OrderByDescending(x => x.Sorting)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":271},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .ToList();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":272},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":273},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":274},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task RepairDataAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":275},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":276},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var list = await Repository.GetListAsync(x => x.ParentId == null);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":277},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":278},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            foreach (var entity in list)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":279},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":280},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                await SetEntityAsync(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":281},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":282},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                await UpdateAsync(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":283},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":284},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":285},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":286},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual Task SetEntityAsync(T entity)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":287},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":288},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Logger.LogInformation($\"SetEntityAsync:{entity}\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":289},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":290},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            entity.SetName(entity.Name);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":291},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":292},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Task.CompletedTask;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":293},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":294},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":295},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesapplicationcontracts"},"children":[{"type":"text","value":"IczpNet.AbpTrees.Application.Contracts"}]},{"type":"element","tag":"h5","props":{"id":"itreeappservice"},"children":[{"type":"text","value":"ITreeAppService"}]},{"type":"element","tag":"pre","props":{"code":"using System;\nusing System.Collections.Generic;\nusing System.Threading.Tasks;\nusing Volo.Abp.Application.Services;\n\nnamespace IczpNet.AbpTrees\n{\n    public interface ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, in TGetListInput, in TCreateInput, in TUpdateInput, TTreeInfo>\n        : ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>\n        where TKey : struct\n        where TTreeInfo : ITreeInfo<TKey>\n    {\n        Task<TTreeInfo> GetItemByCacheAsync(TKey id);\n\n        Task<List<TTreeInfo>> GetManayByCacheAsync(List<TKey> idList);\n\n        Task<List<TTreeInfo>> GetAllByCacheAsync();\n    }\n\n    public interface ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, in TGetListInput, in TCreateInput, in TUpdateInput>\n        : ICrudAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>\n        where TKey : struct\n    {\n\n        Task<List<TGetOutputDto>> GetManyAsync(List<TKey> idList);\n\n        Task<DateTime> RepairDataAsync();\n\n\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Collections.Generic;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Threading.Tasks;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Application.Services;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, in TGetListInput, in TCreateInput, in TUpdateInput, TTreeInfo>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        : ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TTreeInfo : ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<TTreeInfo> GetItemByCacheAsync(TKey id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<TTreeInfo>> GetManayByCacheAsync(List<TKey> idList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<TTreeInfo>> GetAllByCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, in TGetListInput, in TCreateInput, in TUpdateInput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        : ICrudAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<List<TGetOutputDto>> GetManyAsync(List<TKey> idList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Task<DateTime> RepairDataAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"dtos"},"children":[{"type":"text","value":"Dtos"}]},{"type":"element","tag":"h5","props":{"id":"itreegetlistinput"},"children":[{"type":"text","value":"ITreeGetListInput"}]},{"type":"element","tag":"pre","props":{"code":"namespace IczpNet.AbpTrees.Dtos\n{\n    public interface ITreeGetListInput<TKey> where TKey : struct\n    {\n        bool IsEnabledParentId { get; set; }\n\n        int? Depth { get; set; }\n\n        TKey? ParentId { get; set; }\n\n        string Keyword { get; set; }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees.Dtos\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeGetListInput<TKey> where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        bool IsEnabledParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        int? Depth { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        TKey? ParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        string Keyword { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h5","props":{"id":"itreeinput"},"children":[{"type":"text","value":"ITreeInput"}]},{"type":"element","tag":"pre","props":{"code":"using System;\n\nnamespace IczpNet.AbpTrees.Dtos\n{\n    public interface ITreeInput<TKey> where TKey : struct\n    {\n        string Name { get; set; }\n        TKey? ParentId { get; set; }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees.Dtos\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface ITreeInput<TKey> where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        string Name { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        TKey? ParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h5","props":{"id":"treegetlistinput"},"children":[{"type":"text","value":"TreeGetListInput"}]},{"type":"element","tag":"pre","props":{"code":"using System.ComponentModel;\nusing Volo.Abp.Application.Dtos;\n\nnamespace IczpNet.AbpTrees.Dtos\n{\n    public class TreeGetListInput<TKey> : PagedAndSortedResultRequestDto, ITreeGetListInput<TKey> where TKey : struct\n    {\n        [DefaultValue(false)]\n        public virtual bool IsEnabledParentId { get; set; }\n\n        [DefaultValue(null)]\n        public virtual int? Depth { get; set; }\n\n        [DefaultValue(null)]\n        public virtual TKey? ParentId { get; set; }\n\n        [DefaultValue(null)]\n        public virtual string Keyword { get; set; }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.ComponentModel;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Application.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees.Dtos\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class TreeGetListInput<TKey> : PagedAndSortedResultRequestDto, ITreeGetListInput<TKey> where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [DefaultValue(false)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual bool IsEnabledParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [DefaultValue(null)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual int? Depth { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [DefaultValue(null)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual TKey? ParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [DefaultValue(null)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string Keyword { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"iczpnetabptreesapplication"},"children":[{"type":"text","value":"IczpNet.AbpTrees.Application"}]},{"type":"element","tag":"h5","props":{"id":"treeappservice"},"children":[{"type":"text","value":"TreeAppService"}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees.Dtos;\nusing IczpNet.AbpTrees.Statics;\nusing Microsoft.AspNetCore.Mvc;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Volo.Abp.Application.Dtos;\nusing Volo.Abp.Application.Services;\nusing Volo.Abp.Domain.Repositories;\n\nnamespace IczpNet.AbpTrees\n{\n\n    public abstract class TreeAppService<TEntity, TKey, TGetOutputDto, TGetListOutputDto, TGetListInput, TCreateInput, TUpdateInput, TTreeInfo> :\n        TreeAppService<TEntity, TKey, TGetOutputDto, TGetListOutputDto, TGetListInput, TCreateInput, TUpdateInput>,\n        ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput, TTreeInfo>\n        where TEntity : class, ITreeEntity<TEntity, TKey>\n        where TKey : struct\n        where TGetOutputDto : IEntityDto<TKey>\n        where TGetListOutputDto : IEntityDto<TKey>\n        where TGetListInput : ITreeGetListInput<TKey>\n        where TCreateInput : ITreeInput<TKey>\n        where TUpdateInput : ITreeInput<TKey>\n        where TTreeInfo : ITreeInfo<TKey>\n\n    {\n        protected ITreeManager<TEntity, TKey, TTreeInfo> TreeCacheManager => LazyServiceProvider.LazyGetRequiredService<ITreeManager<TEntity, TKey, TTreeInfo>>();\n        protected TreeAppService(IRepository<TEntity, TKey> repository) : base(repository) { }\n\n        [HttpGet]\n        public virtual Task<TTreeInfo> GetItemByCacheAsync(TKey id)\n        {\n            return TreeCacheManager.GetItemByCacheAsync(id);\n        }\n\n        [HttpGet]\n        public virtual Task<List<TTreeInfo>> GetManayByCacheAsync(List<TKey> idList)\n        {\n            return TreeCacheManager.GetManyByCacheAsync(idList);\n        }\n\n        [HttpGet]\n        public virtual async Task<List<TTreeInfo>> GetAllByCacheAsync()\n        {\n            await CheckGetListPolicyAsync();\n\n            return await TreeCacheManager.GetAllByCacheAsync();\n        }\n    }\n\n\n    public abstract class TreeAppService<TEntity, TKey, TGetOutputDto, TGetListOutputDto, TGetListInput, TCreateInput, TUpdateInput> :\n        CrudAppService<TEntity, TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>,\n        ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>\n        where TEntity : class, ITreeEntity<TEntity, TKey>\n        where TKey : struct\n        where TGetOutputDto : IEntityDto<TKey>\n        where TGetListOutputDto : IEntityDto<TKey>\n        where TGetListInput : ITreeGetListInput<TKey>\n        where TCreateInput : ITreeInput<TKey>\n        where TUpdateInput : ITreeInput<TKey>\n\n    {\n        protected virtual string RepairDataPolicyName { get; set; }\n\n        protected virtual ITreeManager<TEntity, TKey> TreeManager => LazyServiceProvider.LazyGetRequiredService<ITreeManager<TEntity, TKey>>();\n\n        public TreeAppService(IRepository<TEntity, TKey> repository) : base(repository) { }\n\n        protected override IQueryable<TEntity> ApplyDefaultSorting(IQueryable<TEntity> query)\n        {\n            return query.OrderByDescending(x => x.Sorting);\n        }\n\n        [HttpGet]\n        public override Task<TGetOutputDto> GetAsync(TKey id)\n        {\n            return base.GetAsync(id);\n        }\n\n\n\n        [HttpGet]\n        public virtual async Task<List<TGetOutputDto>> GetManyAsync(List<TKey> idList)\n        {\n            var list = new List<TGetOutputDto>();\n            foreach (var id in idList)\n            {\n                list.Add(await GetAsync(id));\n            }\n            return list;\n        }\n\n        [HttpGet]\n        public override Task<PagedResultDto<TGetListOutputDto>> GetListAsync(TGetListInput input)\n        {\n            return base.GetListAsync(input);\n        }\n\n        protected override async Task<IQueryable<TEntity>> CreateFilteredQueryAsync(TGetListInput input)\n        {\n            Assert.If(!input.IsEnabledParentId && input.ParentId != null, \"When [IsEnabledParentId]=false,then [ParentId] != null\");\n\n            return (await base.CreateFilteredQueryAsync(input))\n                .WhereIf(input.DepthList != null && input.DepthList.Any(), x => input.DepthList.Contains(x.Depth))\n                .WhereIf(input.IsEnabledParentId, x => x.ParentId.Equals(input.ParentId))\n               //.WhereIf(!string.IsNullOrWhiteSpace(input.Keyword), x => x.Name.Contains(input.Keyword))\n               ;\n        }\n\n\n        [HttpPost]\n        public override async Task<TGetOutputDto> CreateAsync(TCreateInput input)\n        {\n            await CheckCreatePolicyAsync();\n\n            var inputEntity = MapToEntity(input);\n\n            inputEntity.SetName(input.Name);\n\n            inputEntity.SetParentId(input.ParentId);\n\n            var entity = await TreeManager.CreateAsync(inputEntity);\n\n            return ObjectMapper.Map<TEntity, TGetOutputDto>(entity);\n        }\n\n        [HttpPost]\n        public override async Task<TGetOutputDto> UpdateAsync(TKey id, TUpdateInput input)\n        {\n            await CheckUpdatePolicyAsync();\n\n            var entity = await GetEntityByIdAsync(id);\n\n            await MapToEntityAsync(input, entity);\n\n            entity.SetName(input.Name);\n\n            entity.SetParentId(input.ParentId);\n\n            await TreeManager.UpdateAsync(entity);\n\n            return await MapToGetOutputDtoAsync(entity);\n        }\n\n        [HttpPost]\n        public override async Task DeleteAsync(TKey id)\n        {\n            await CheckDeletePolicyAsync();\n\n            await TreeManager.DeleteAsync(id);\n        }\n\n        [HttpPost]\n        public virtual async Task<DateTime> RepairDataAsync()\n        {\n            await CheckRepairDataPolicyAsync();\n\n            await TreeManager.RepairDataAsync();\n\n            return Clock.Now;\n        }\n\n        protected virtual async Task CheckRepairDataPolicyAsync()\n        {\n            await CheckPolicyAsync(RepairDataPolicyName);\n        }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Statics;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Microsoft.AspNetCore.Mvc;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Collections.Generic;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Linq;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.Threading.Tasks;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Application.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Application.Services;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Domain.Repositories;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTrees\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public abstract class TreeAppService<TEntity, TKey, TGetOutputDto, TGetListOutputDto, TGetListInput, TCreateInput, TUpdateInput, TTreeInfo> :\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        TreeAppService<TEntity, TKey, TGetOutputDto, TGetListOutputDto, TGetListInput, TCreateInput, TUpdateInput>,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput, TTreeInfo>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TEntity : class, ITreeEntity<TEntity, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TGetOutputDto : IEntityDto<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TGetListOutputDto : IEntityDto<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TGetListInput : ITreeGetListInput<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TCreateInput : ITreeInput<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TUpdateInput : ITreeInput<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TTreeInfo : ITreeInfo<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected ITreeManager<TEntity, TKey, TTreeInfo> TreeCacheManager => LazyServiceProvider.LazyGetRequiredService<ITreeManager<TEntity, TKey, TTreeInfo>>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected TreeAppService(IRepository<TEntity, TKey> repository) : base(repository) { }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpGet]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<TTreeInfo> GetItemByCacheAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return TreeCacheManager.GetItemByCacheAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpGet]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual Task<List<TTreeInfo>> GetManayByCacheAsync(List<TKey> idList)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return TreeCacheManager.GetManyByCacheAsync(idList);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpGet]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<List<TTreeInfo>> GetAllByCacheAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await CheckGetListPolicyAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return await TreeCacheManager.GetAllByCacheAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public abstract class TreeAppService<TEntity, TKey, TGetOutputDto, TGetListOutputDto, TGetListInput, TCreateInput, TUpdateInput> :\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        CrudAppService<TEntity, TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        ITreeAppService<TGetOutputDto, TGetListOutputDto, TKey, TGetListInput, TCreateInput, TUpdateInput>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TEntity : class, ITreeEntity<TEntity, TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TKey : struct\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TGetOutputDto : IEntityDto<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TGetListOutputDto : IEntityDto<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TGetListInput : ITreeGetListInput<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TCreateInput : ITreeInput<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        where TUpdateInput : ITreeInput<TKey>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual string RepairDataPolicyName { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual ITreeManager<TEntity, TKey> TreeManager => LazyServiceProvider.LazyGetRequiredService<ITreeManager<TEntity, TKey>>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public TreeAppService(IRepository<TEntity, TKey> repository) : base(repository) { }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected override IQueryable<TEntity> ApplyDefaultSorting(IQueryable<TEntity> query)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return query.OrderByDescending(x => x.Sorting);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpGet]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override Task<TGetOutputDto> GetAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return base.GetAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpGet]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<List<TGetOutputDto>> GetManyAsync(List<TKey> idList)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var list = new List<TGetOutputDto>();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            foreach (var id in idList)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                list.Add(await GetAsync(id));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return list;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpGet]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override Task<PagedResultDto<TGetListOutputDto>> GetListAsync(TGetListInput input)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return base.GetListAsync(input);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected override async Task<IQueryable<TEntity>> CreateFilteredQueryAsync(TGetListInput input)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":102},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":103},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Assert.If(!input.IsEnabledParentId && input.ParentId != null, \"When [IsEnabledParentId]=false,then [ParentId] != null\");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":104},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":105},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return (await base.CreateFilteredQueryAsync(input))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":106},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .WhereIf(input.DepthList != null && input.DepthList.Any(), x => input.DepthList.Contains(x.Depth))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":107},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .WhereIf(input.IsEnabledParentId, x => x.ParentId.Equals(input.ParentId))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":108},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"               //.WhereIf(!string.IsNullOrWhiteSpace(input.Keyword), x => x.Name.Contains(input.Keyword))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":109},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"               ;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":110},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":111},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":112},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":113},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpPost]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":114},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override async Task<TGetOutputDto> CreateAsync(TCreateInput input)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":115},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":116},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await CheckCreatePolicyAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":117},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":118},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var inputEntity = MapToEntity(input);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":119},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":120},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            inputEntity.SetName(input.Name);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":121},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":122},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            inputEntity.SetParentId(input.ParentId);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":123},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":124},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entity = await TreeManager.CreateAsync(inputEntity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":125},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":126},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return ObjectMapper.Map<TEntity, TGetOutputDto>(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":127},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":128},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":129},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpPost]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":130},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override async Task<TGetOutputDto> UpdateAsync(TKey id, TUpdateInput input)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":131},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":132},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await CheckUpdatePolicyAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":133},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":134},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            var entity = await GetEntityByIdAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":135},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":136},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await MapToEntityAsync(input, entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":137},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":138},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            entity.SetName(input.Name);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":139},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":140},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            entity.SetParentId(input.ParentId);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":141},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":142},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await TreeManager.UpdateAsync(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":143},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":144},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return await MapToGetOutputDtoAsync(entity);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":145},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":146},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":147},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpPost]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":148},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public override async Task DeleteAsync(TKey id)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":149},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":150},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await CheckDeletePolicyAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":151},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":152},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await TreeManager.DeleteAsync(id);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":153},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":154},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":155},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        [HttpPost]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":156},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual async Task<DateTime> RepairDataAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":157},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":158},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await CheckRepairDataPolicyAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":159},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":160},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await TreeManager.RepairDataAsync();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":161},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":162},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            return Clock.Now;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":163},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":164},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":165},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        protected virtual async Task CheckRepairDataPolicyAsync()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":166},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":167},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            await CheckPolicyAsync(RepairDataPolicyName);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":168},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":169},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":170},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"usage"},"children":[{"type":"text","value":"Usage"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/Iczp/AbpTrees/tree/master/Example","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/Iczp/AbpTrees/tree/master/Example"}]}]},{"type":"element","tag":"h4","props":{"id":"create-a-entity"},"children":[{"type":"text","value":"Create a entity"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Create a entity "},{"type":"element","tag":"span","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Department"}]}]},{"type":"text","value":" and implement "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"TreeEntity<T>"}]},{"type":"text","value":"."},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments\n{\n    public class Department : TreeEntity<Department, Guid>\n    {\n    }\n}\n","language":"c#","meta":"","className":"language-c# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"using"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":" IczpNet"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"AbpTrees"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"using"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":" System"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"namespace"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":" IczpNet"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"AbpTreesDemo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"Departments\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"    public"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":" Department"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" : "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"TreeEntity"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"Department"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":"Guid"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"}\n"}]}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"create-model"},"children":[{"type":"text","value":"Create Model"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Create "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentInfo"}]},{"type":"text","value":" and implement "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"TreeInfo"}]},{"type":"text","value":" in project "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Domain.Shared"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments\n{\n    public class DepartmentInfo : TreeInfo<Guid>\n    {\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class DepartmentInfo : TreeInfo<Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"repository"},"children":[{"type":"text","value":"Repository"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.EntityFrameworkCore"}]},{"type":"text","value":" "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"AbpTreesDemoDbContext.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"public DbSet<Department> Department { get; }\nusing IczpNet.AbpTreesDemo.Departments;\nusing Microsoft.EntityFrameworkCore;\nusing Volo.Abp.Data;\nusing Volo.Abp.EntityFrameworkCore;\n\nnamespace IczpNet.AbpTreesDemo.EntityFrameworkCore;\n\n[ConnectionStringName(AbpTreesDemoDbProperties.ConnectionStringName)]\npublic class AbpTreesDemoDbContext : AbpDbContext<AbpTreesDemoDbContext>, IAbpTreesDemoDbContext\n{\n    /* Add DbSet for each Aggregate Root here. Example:\n     * public DbSet<Question> Questions { get; set; }\n     */\n\n    public AbpTreesDemoDbContext(DbContextOptions<AbpTreesDemoDbContext> options)\n        : base(options)\n    {\n\n    }\n    /// <summary>\n    /// Department\n    /// </summary>\n    public DbSet<Department> Department { get; }\n\n    protected override void OnModelCreating(ModelBuilder builder)\n    {\n        base.OnModelCreating(builder);\n\n        builder.ConfigureAbpTreesDemo();\n    }\n}\n","language":"swift","meta":"","className":"language-swift shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public DbSet<Department> Department { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTreesDemo.Departments;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Microsoft.EntityFrameworkCore;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Data;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.EntityFrameworkCore;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.EntityFrameworkCore;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[ConnectionStringName(AbpTreesDemoDbProperties.ConnectionStringName)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class AbpTreesDemoDbContext : AbpDbContext<AbpTreesDemoDbContext>, IAbpTreesDemoDbContext\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    /* Add DbSet for each Aggregate Root here. Example:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"     * public DbSet<Question> Questions { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"     */\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public AbpTreesDemoDbContext(DbContextOptions<AbpTreesDemoDbContext> options)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        : base(options)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    /// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    /// Department\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    /// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public DbSet<Department> Department { get; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    protected override void OnModelCreating(ModelBuilder builder)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        base.OnModelCreating(builder);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        builder.ConfigureAbpTreesDemo();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"AbpTreesDemoDbContextModelCreatingExtensions.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTreesDemo.Departments;\nusing Microsoft.EntityFrameworkCore;\nusing Volo.Abp;\nusing Volo.Abp.EntityFrameworkCore.Modeling;\n\nnamespace IczpNet.AbpTreesDemo.EntityFrameworkCore;\n\npublic static class AbpTreesDemoDbContextModelCreatingExtensions\n{\n    public static void ConfigureAbpTreesDemo(\n        this ModelBuilder builder)\n    {\n        Check.NotNull(builder, nameof(builder));\n\n        builder.Entity<Department>(b =>\n        {\n            //Configure table & schema name\n            b.ToTable(AbpTreesDemoDbProperties.DbTablePrefix + nameof(Department), AbpTreesDemoDbProperties.DbSchema);\n\n            b.ConfigureByConvention();\n\n            //Indexes\n            b.HasIndex(q => q.CreationTime);\n\n        });\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTreesDemo.Departments;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Microsoft.EntityFrameworkCore;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.EntityFrameworkCore.Modeling;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.EntityFrameworkCore;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public static class AbpTreesDemoDbContextModelCreatingExtensions\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public static void ConfigureAbpTreesDemo(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        this ModelBuilder builder)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Check.NotNull(builder, nameof(builder));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        builder.Entity<Department>(b =>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //Configure table & schema name\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            b.ToTable(AbpTreesDemoDbProperties.DbTablePrefix + nameof(Department), AbpTreesDemoDbProperties.DbSchema);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            b.ConfigureByConvention();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            //Indexes\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            b.HasIndex(q => q.CreationTime);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"create-dto"},"children":[{"type":"text","value":"Create Dto"}]},{"type":"element","tag":"pre","props":{"code":"IczpNet.AbpTreesDemo.Application.Contracts\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Application.Contracts\n"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentCreateInput"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees.Dtos;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos;\n\n/// <summary>\n/// DepartmentCreateInput\n/// </summary>\npublic class DepartmentCreateInput : DepartmentUpdateInput, ITreeInput<Guid>\n{\n\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"/// <summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"/// DepartmentCreateInput\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"/// </summary>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class DepartmentCreateInput : DepartmentUpdateInput, ITreeInput<Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentDto.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using System;\nusing Volo.Abp.Application.Dtos;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos\n{\n    public class DepartmentDto : DepartmentInfo, IEntityDto<Guid>\n    {\n        public virtual double Sorting { get; set; }\n        public virtual string Description { get; set; }\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using Volo.Abp.Application.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public class DepartmentDto : DepartmentInfo, IEntityDto<Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual double Sorting { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        public virtual string Description { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentGetAllListWithChildsInput.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using System;\nusing System.ComponentModel;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos;\n\npublic class DepartmentGetAllListWithChildsInput \n{\n    [DefaultValue(null)]\n    public virtual Guid? ParentId { get; set; }\n    public virtual bool IsImportAllChilds { get; set; }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System.ComponentModel;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class DepartmentGetAllListWithChildsInput \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    [DefaultValue(null)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual Guid? ParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual bool IsImportAllChilds { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentGetListInput.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees.Dtos;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos;\n\npublic class DepartmentGetListInput : TreeGetListInput<Guid>\n{\n\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class DepartmentGetListInput : TreeGetListInput<Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentUpdateInput.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees.Dtos;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos;\n\npublic class DepartmentUpdateInput : ITreeInput<Guid>\n{\n    public virtual Guid? ParentId { get; set; }\n    public virtual string Name { get; set; }\n    public virtual double Sorting { get; set; }\n    public virtual string Description { get; set; }\n\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class DepartmentUpdateInput : ITreeInput<Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual Guid? ParentId { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual string Name { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual double Sorting { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual string Description { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentWithChildsDto.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos;\n\npublic class DepartmentWithChildsDto : TreeWithChildsInfo<DepartmentWithChildsDto, Guid>\n{\n    public virtual int ChildsCount { get; set; }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class DepartmentWithChildsDto : TreeWithChildsInfo<DepartmentWithChildsDto, Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual int ChildsCount { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DepartmentWithParentDto.cs"}]}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments.Dtos;\n\npublic class DepartmentWithParentDto : TreeWithParentInfo<DepartmentWithParentDto, Guid>\n{\n    public virtual double Sorting { get; set; }\n    public virtual string Description { get; set; }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class DepartmentWithParentDto : TreeWithParentInfo<DepartmentWithParentDto, Guid>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual double Sorting { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public virtual string Description { get; set; }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"interface-crud"},"children":[{"type":"text","value":"interface CRUD"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"IDepartmentAppSevice and implement "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ICrudAppService"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ITreeAppService"}]}]},{"type":"element","tag":"pre","props":{"code":"using IczpNet.AbpTrees;\nusing IczpNet.AbpTreesDemo.Departments.Dtos;\nusing System;\n\nnamespace IczpNet.AbpTreesDemo.Departments\n{\n    public interface IDepartmentAppSevice :\n        ITreeAppService<DepartmentDto,\n            DepartmentDto,\n            Guid,\n            DepartmentGetListInput,\n            DepartmentCreateInput,\n            DepartmentUpdateInput, DepartmentInfo>\n    {\n    }\n}\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTrees;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using IczpNet.AbpTreesDemo.Departments.Dtos;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"using System;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"namespace IczpNet.AbpTreesDemo.Departments\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    public interface IDepartmentAppSevice :\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        ITreeAppService<DepartmentDto,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            DepartmentDto,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            Guid,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            DepartmentGetListInput,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            DepartmentCreateInput,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            DepartmentUpdateInput, DepartmentInfo>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"application-crud"},"children":[{"type":"text","value":"Application CRUD"}]},{"type":"element","tag":"pre","props":{"code":"IczpNet.AbpTreesDemo.Application` > `DepartmentAppsevice.cs\nusing IczpNet.AbpTrees;\nusing IczpNet.AbpTreesDemo.Departments.Dtos;\nusing Microsoft.AspNetCore.Mvc;\nusing System;\nusing Volo.Abp.Domain.Repositories;\n\nnamespace IczpNet.AbpTreesDemo.Departments\n{\n\n    [Route($\"Api/App/{AbpTreesDemoRemoteServiceConsts.ModuleName}/[Controller]/[Action]\")]\n    public class DepartmentAppService\n        : TreeAppService<\n            Department,\n            Guid,\n            DepartmentDto,\n            DepartmentDto,\n            DepartmentGetListInput,\n            DepartmentCreateInput,\n            DepartmentUpdateInput,\n            DepartmentInfo>,\n        IDepartmentAppSevice\n    {\n        public DepartmentAppService(IRepository<Department, Guid> repository) : base(repository)\n        {\n        }\n    }\n}\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.Application` > `DepartmentAppsevice.cs\nusing IczpNet.AbpTrees;\nusing IczpNet.AbpTreesDemo.Departments.Dtos;\nusing Microsoft.AspNetCore.Mvc;\nusing System;\nusing Volo.Abp.Domain.Repositories;\n\nnamespace IczpNet.AbpTreesDemo.Departments\n{\n\n    [Route($\"Api/App/{AbpTreesDemoRemoteServiceConsts.ModuleName}/[Controller]/[Action]\")]\n    public class DepartmentAppService\n        : TreeAppService<\n            Department,\n            Guid,\n            DepartmentDto,\n            DepartmentDto,\n            DepartmentGetListInput,\n            DepartmentCreateInput,\n            DepartmentUpdateInput,\n            DepartmentInfo>,\n        IDepartmentAppSevice\n    {\n        public DepartmentAppService(IRepository<Department, Guid> repository) : base(repository)\n        {\n        }\n    }\n}\n"}]}]},{"type":"element","tag":"h4","props":{"id":"dto-mapper"},"children":[{"type":"text","value":"Dto Mapper"}]},{"type":"element","tag":"pre","props":{"code":"AbpTreesDemoApplicationAutoMapperProfile\nusing AutoMapper;\nusing IczpNet.AbpTreesDemo.Departments;\nusing IczpNet.AbpTreesDemo.Departments.Dtos;\nusing Volo.Abp.AutoMapper;\n\nnamespace IczpNet.AbpTreesDemo;\n\npublic class AbpTreesDemoApplicationAutoMapperProfile : Profile\n{\n    public AbpTreesDemoApplicationAutoMapperProfile()\n    {\n        /* You can configure your AutoMapper mapping configuration here.\n         * Alternatively, you can split your mapping configurations\n         * into multiple profile classes for a better organization. */\n\n        CreateMap<Department, DepartmentDto>(MemberList.Destination);\n        CreateMap<Department, DepartmentWithParentDto>(MemberList.Destination);\n        CreateMap<Department, DepartmentWithChildsDto>(MemberList.Destination)\n             .ForMember(s => s.ChildsCount, map => map.MapFrom(d => d.GetChildsCount()))\n             //.ForMember(s => s.UserCount, map => map.MapFrom(d => d.GetUserCount()))\n             ;\n        CreateMap<DepartmentCreateInput, Department>(MemberList.Source).IgnoreAllPropertiesWithAnInaccessibleSetter();\n        CreateMap<DepartmentUpdateInput, Department>(MemberList.Source).IgnoreAllPropertiesWithAnInaccessibleSetter();\n\n\n        CreateMap<Department, DepartmentInfo>();\n        CreateMap<DepartmentInfo, DepartmentWithChildsDto>()\n            .Ignore(x => x.ChildsCount)\n            .Ignore(x => x.Childs);\n    }\n}\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"AbpTreesDemoApplicationAutoMapperProfile\nusing AutoMapper;\nusing IczpNet.AbpTreesDemo.Departments;\nusing IczpNet.AbpTreesDemo.Departments.Dtos;\nusing Volo.Abp.AutoMapper;\n\nnamespace IczpNet.AbpTreesDemo;\n\npublic class AbpTreesDemoApplicationAutoMapperProfile : Profile\n{\n    public AbpTreesDemoApplicationAutoMapperProfile()\n    {\n        /* You can configure your AutoMapper mapping configuration here.\n         * Alternatively, you can split your mapping configurations\n         * into multiple profile classes for a better organization. */\n\n        CreateMap<Department, DepartmentDto>(MemberList.Destination);\n        CreateMap<Department, DepartmentWithParentDto>(MemberList.Destination);\n        CreateMap<Department, DepartmentWithChildsDto>(MemberList.Destination)\n             .ForMember(s => s.ChildsCount, map => map.MapFrom(d => d.GetChildsCount()))\n             //.ForMember(s => s.UserCount, map => map.MapFrom(d => d.GetUserCount()))\n             ;\n        CreateMap<DepartmentCreateInput, Department>(MemberList.Source).IgnoreAllPropertiesWithAnInaccessibleSetter();\n        CreateMap<DepartmentUpdateInput, Department>(MemberList.Source).IgnoreAllPropertiesWithAnInaccessibleSetter();\n\n\n        CreateMap<Department, DepartmentInfo>();\n        CreateMap<DepartmentInfo, DepartmentWithChildsDto>()\n            .Ignore(x => x.ChildsCount)\n            .Ignore(x => x.Childs);\n    }\n}\n"}]}]},{"type":"element","tag":"h4","props":{"id":"add-migration-iczpnetabptreesdemohttpapihost"},"children":[{"type":"text","value":"Add-Migration "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.HttpApi.Host"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Select Project "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.HttpApi.Host"}]},{"type":"text","value":", Set Run Start."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Open PM"},{"type":"element","tag":"pre","props":{"code":"PM> Add-Migration Department_Init\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"PM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"Add-Migration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" Department_Init\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"PM> Update-Database\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"PM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"Update-Database\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add Controller "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"AbpTreesDemoHttpApiHostModule.cs"}]},{"type":"element","tag":"pre","props":{"code":"//...\npublic override void ConfigureServices(ServiceConfigurationContext context)\n{\n//...\n        Configure<AbpAspNetCoreMvcOptions>(options =>\n        {\n            options\n                .ConventionalControllers\n                .Create(typeof(AbpTreesDemoApplicationModule).Assembly);\n        });\n  //...\n}\n\n//...\n","language":"C#","meta":"","className":"language-C# shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"//...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public override void ConfigureServices(ServiceConfigurationContext context)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"//...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        Configure<AbpAspNetCoreMvcOptions>(options =>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"            options\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .ConventionalControllers\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"                .Create(typeof(AbpTreesDemoApplicationModule).Assembly);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"  //...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"//...\n"}]}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"run"},"children":[{"type":"text","value":"Run"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Set as Startup Project:"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.HttpApi.Host"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ConnectionStrings:"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"appsettings.json"}]},{"type":"element","tag":"pre","props":{"code":"{\n  \"App\": {\n    \"CorsOrigins\": \"https://*.AbpTreesDemo.com,http://localhost:4200,http://localhost:44307,https://localhost:44307\"\n  },\n  \"ConnectionStrings\": {\n    \"Default\": \"Server=localhost;Initial Catalog=AbpTreesDemo_Main;User ID=sa;Password=123;TrustServerCertificate=True\",\n    \"AbpTreesDemo\": \"Server=localhost;Initial Catalog=AbpTreesDemo_Module;User ID=sa;Password=123;TrustServerCertificate=True\"\n  },\n  \"Redis\": {\n    \"Configuration\": \"127.0.0.1\"\n  },\n  \"AuthServer\": {\n    \"Authority\": \"https://localhost:44362/\",\n    \"RequireHttpsMetadata\": \"false\",\n    \"SwaggerClientId\": \"AbpTreesDemo_Swagger\",\n    \"SwaggerClientSecret\": \"1q2w3e*\"\n  }\n}\n","language":"json","meta":"","className":"language-json shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"App\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"CorsOrigins\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"https://*.AbpTreesDemo.com,http://localhost:4200,http://localhost:44307,https://localhost:44307\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"ConnectionStrings\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"Default\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"Server=localhost;Initial Catalog=AbpTreesDemo_Main;User ID=sa;Password=123;TrustServerCertificate=True\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"AbpTreesDemo\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"Server=localhost;Initial Catalog=AbpTreesDemo_Module;User ID=sa;Password=123;TrustServerCertificate=True\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"Redis\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"Configuration\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"127.0.0.1\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"AuthServer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"Authority\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"https://localhost:44362/\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"RequireHttpsMetadata\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"false\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"SwaggerClientId\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"AbpTreesDemo_Swagger\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"SwaggerClientSecret\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"1q2w3e*\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"}\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Set PM(Package Management Console) default Project:"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"IczpNet.AbpTreesDemo.HttpApi.Host"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"add-migration and update database"},{"type":"element","tag":"pre","props":{"code":"PM> Add-Migration Department_Init\n","language":"shell","meta":"","className":"language-shell shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"PM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"Add-Migration"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" Department_Init\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"PM> Update-Database\n","language":"shell","meta":"","className":"language-shell shiki shiki-themes github-dark github-dark monokai","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"PM"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"Update-Database\n"}]}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"upgrade-v1013add-property-childrencount"},"children":[{"type":"text","value":"Upgrade v1.0.13(Add Property ChildrenCount)"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}"}]}],"toc":{"title":"","searchDepth":5,"depth":5,"links":[{"id":"iczpnetabptrees","depth":2,"text":"IczpNet.AbpTrees","children":[{"id":"create-project-by-abp-cli","depth":3,"text":"Create project by Abp Cli"},{"id":"build","depth":3,"text":"Build"},{"id":"public-to-nugetorg","depth":3,"text":"Public to Nuget.org","children":[{"id":"install-the-following-nuget-packages-see-how","depth":5,"text":"Install the following NuGet packages. (see how)"},{"id":"add-dependsontypeofabptreesxxxmodule-attribute-to-configure-the-module-dependencies","depth":5,"text":"Add DependsOn(typeof(AbpTreesXxxModule)) attribute to configure the module dependencies."},{"id":"iczpnetabptreesdemodomain","depth":4,"text":"IczpNet.AbpTreesDemo.Domain"},{"id":"iczpnetabptreesdemodomainshared","depth":4,"text":"IczpNet.AbpTreesDemo.Domain.Shared"},{"id":"iczpnetabptreesdemoapplicationcontracts","depth":4,"text":"IczpNet.AbpTreesDemo.Application.Contracts"},{"id":"iczpnetabptreesdemoapplication","depth":4,"text":"IczpNet.AbpTreesDemo.Application"}]}]},{"id":"internal-structure","depth":2,"text":"Internal structure","children":[{"id":"iczpnetabptreesdomain","depth":4,"text":"IczpNet.AbpTrees.Domain","children":[{"id":"itreeentity","depth":5,"text":"ITreeEntity"},{"id":"treeentity","depth":5,"text":"TreeEntity"},{"id":"itreemanager","depth":5,"text":"ITreeManager"},{"id":"treemanager","depth":5,"text":"TreeManager"}]},{"id":"iczpnetabptreesapplicationcontracts","depth":4,"text":"IczpNet.AbpTrees.Application.Contracts","children":[{"id":"itreeappservice","depth":5,"text":"ITreeAppService"}]},{"id":"dtos","depth":4,"text":"Dtos","children":[{"id":"itreegetlistinput","depth":5,"text":"ITreeGetListInput"},{"id":"itreeinput","depth":5,"text":"ITreeInput"},{"id":"treegetlistinput","depth":5,"text":"TreeGetListInput"}]},{"id":"iczpnetabptreesapplication","depth":4,"text":"IczpNet.AbpTrees.Application","children":[{"id":"treeappservice","depth":5,"text":"TreeAppService"}]}]},{"id":"usage","depth":2,"text":"Usage","children":[{"id":"create-a-entity","depth":4,"text":"Create a entity"},{"id":"create-model","depth":4,"text":"Create Model"},{"id":"repository","depth":4,"text":"Repository"},{"id":"create-dto","depth":4,"text":"Create Dto"},{"id":"interface-crud","depth":4,"text":"interface CRUD"},{"id":"application-crud","depth":4,"text":"Application CRUD"},{"id":"dto-mapper","depth":4,"text":"Dto Mapper"},{"id":"add-migration-iczpnetabptreesdemohttpapihost","depth":4,"text":"Add-Migration IczpNet.AbpTreesDemo.HttpApi.Host"}]},{"id":"run","depth":2,"text":"Run","children":[{"id":"upgrade-v1013add-property-childrencount","depth":4,"text":"Upgrade v1.0.13(Add Property ChildrenCount)"}]}]}},"_type":"markdown","_id":"content:notes:net:iczp-nuget.md","_source":"content","_file":"notes/net/iczp-nuget.md","_extension":"md"}